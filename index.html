<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QuestLog | Guilds & Glory</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="sidebar">
        <div class="brand">
            <i class="fas fa-dragon"></i>
            <span>QuestLog</span>
        </div>
        <nav id="sidebar-nav">
            <div class="tab active" onclick="showContent('dashboard', this)">
                <i class="fas fa-chart-line"></i> Dashboard
            </div>
            <div class="tab" onclick="showContent('training', this)">
                <i class="fas fa-dumbbell"></i> Training
            </div>
            <div class="tab" onclick="showContent('quests', this)">
                <i class="fas fa-scroll"></i> Quests
            </div>
            <div class="tab" onclick="showContent('boss-fights', this)">
                <i class="fas fa-skull-crossbones"></i> Bosses
            </div>
            <div class="tab" onclick="showContent('guild-section', this)">
                <i class="fas fa-shield-halved"></i> Guilds
            </div>
            <div class="tab" onclick="showContent('achievements', this)">
                <i class="fas fa-trophy"></i> Achievements
            </div>
        </nav>
        <div class="sidebar-footer">
            <button onclick="resetData()" class="reset-btn">Reset Progress</button>
        </div>
    </div>

    <div class="main-content">
        <!-- Dashboard / Profile Page -->
        <div class="content active" id="dashboard">
            <div class="dashboard-layout">
                <div class="profile-main">
                    <header><h1>Hero Profile</h1></header>
                    
                    <div class="profile-card">
                        <div class="avatar-upload">
                            <div class="avatar-preview">
                                <img id="imagePreview" src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="Hero">
                                <div class="upload-overlay" onclick="document.getElementById('imageUpload').click();">
                                    <i class="fas fa-camera"></i>
                                </div>
                            </div>
                            <input type='file' id="imageUpload" accept=".png, .jpg, .jpeg" hidden />
                        </div>

                        <div class="profile-info">
                            <div class="name-container">
                                <h2 id="heroName" contenteditable="true" onblur="saveProfileName()">Hero</h2>
                                <div class="currency">
                                    <i class="fas fa-coins" style="color: #fbbf24;"></i>
                                    <span id="goldCount">0</span>
                                </div>
                            </div>
                            <p class="rank-text">Rank: <span id="rankTitle">Novice Adventurer</span></p>
                            
                            <div class="level-badge-container">
                                <div class="level-circle"><span id="displayLevel">1</span></div>
                                <div class="level-progress-info">
                                    <span>XP Progress</span>
                                    <span id="progressPercent">0%</span>
                                </div>
                            </div>

                            <div class="stats-bar">
                                <div class="bar-container">
                                    <span class="label">XP</span>
                                    <div class="bar"><div class="fill xp" id="lvlBar" style="width: 0%;"></div></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="notification-card" id="levelUpNotif">
                        <i class="fas fa-bolt"></i>
                        <span id="notifText">Welcome to the Realm!</span>
                    </div>
                </div>

                <!-- Admin Event Panel -->
                <aside class="event-panel">
                    <h3><i class="fas fa-crown"></i> Admin Events</h3>
                    <p class="small-text">Tasks posted by the Creator</p>
                    <div id="admin-events-list">
                        <!-- Events populated by JS -->
                    </div>
                    <div class="admin-controls" id="adminOnlyUI">
                        <hr>
                        <p style="font-size: 0.7rem; color: var(--accent-blue);">ADMIN OVERRIDE</p>
                        <input type="text" id="newEventTitle" placeholder="Event Name...">
                        <input type="number" id="newEventGold" placeholder="Gold Reward">
                        <button onclick="adminPostEvent()" class="admin-btn">Post Event</button>
                    </div>
                </aside>
            </div>
        </div>

        <!-- Guild Section -->
        <div class="content" id="guild-section">
            <header>
                <h1>Guild Hall</h1>
                <div id="guild-creation-zone">
                    <button class="create-guild-btn" onclick="openGuildModal()">Create Guild (500 Gold)</button>
                </div>
            </header>

            <div id="active-guild-view" style="display: none;">
                <div class="guild-header-card">
                    <div class="guild-banner" id="myGuildBanner">G</div>
                    <div>
                        <h2 id="myGuildName">Guild Name</h2>
                        <p id="myGuildStats">Members: 1 | Rank: #--</p>
                    </div>
                    <button class="war-btn" onclick="startGuildWar()">Start Guild War</button>
                </div>
                
                <div class="guild-grid">
                    <div class="guild-box">
                        <h3>Guild Chat</h3>
                        <div id="guildChat" class="chat-area"></div>
                        <div class="input-group">
                            <input type="text" id="chatInput" placeholder="Send message...">
                            <button onclick="sendGuildChat()">Send</button>
                        </div>
                    </div>
                    <div class="guild-box">
                        <h3>Guild Tasks</h3>
                        <div id="guild-tasks-list"></div>
                        <div class="input-group">
                            <input type="text" id="gTaskInput" placeholder="Assign task to members...">
                            <button onclick="addGuildTask()">Assign</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="guild-discovery">
                <h3>Available Guilds</h3>
                <div class="task-grid" id="all-guilds-list">
                    <!-- Simulated Guilds -->
                </div>
            </div>
        </div>

        <!-- Task Sections (Training, Quests, Bosses) -->
        <div class="content" id="training">
            <header><h1>Training Grounds</h1></header>
            <div class="input-group">
                <input type="text" id="training-input" placeholder="New drill...">
                <button onclick="addTask('training')"><i class="fas fa-plus"></i></button>
            </div>
            <div id="training-list" class="task-grid"></div>
        </div>

        <div class="content" id="quests">
            <header><h1>Quest Board</h1></header>
            <div class="input-group">
                <input type="text" id="quests-input" placeholder="New quest...">
                <button onclick="addTask('quests')"><i class="fas fa-plus"></i></button>
            </div>
            <div id="quests-list" class="task-grid"></div>
        </div>

        <div class="content" id="boss-fights">
            <header><h1>Bosses</h1></header>
            <div class="input-group">
                <input type="text" id="boss-input" placeholder="Summon Boss...">
                <button onclick="addTask('boss')"><i class="fas fa-skull"></i></button>
            </div>
            <div id="boss-list" class="task-grid"></div>
        </div>

        <div class="content" id="achievements">
            <header><h1>Hall of Fame</h1></header>
            <div id="achievements-list" class="task-grid"></div>
        </div>
    </div>

    <!-- Modals -->
    <div id="guildModal" class="modal">
        <div class="modal-content">
            <h2>Establish New Guild</h2>
            <p>Cost: 500 Gold</p>
            <input type="text" id="newGuildName" placeholder="Enter Guild Name...">
            <div class="modal-btns">
                <button onclick="confirmCreateGuild()" class="confirm-btn">Create</button>
                <button onclick="closeGuildModal()" class="cancel-btn">Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>